from dataclasses import dataclass, field
from typing import List, Optional, Dict
from datetime import datetime

@dataclass
class VulnerabilityFinding:
    name: str
    description: str
    risk_level: str
    confidence: str
    url: str
    payload: str
    proof: str
    remediation: str
    timestamp: datetime = field(default_factory=datetime.now)
    request_data: Optional[str] = None
    response_data: Optional[str] = None

@dataclass
class TrafficLog:
    id: int
    timestamp: str
    method: str
    url: str
    status_code: int
    request_headers: str
    request_body: str
    response_headers: str
    response_body: str

@dataclass
class ScanResult:
    target: str
    start_time: datetime
    end_time: Optional[datetime] = None
    findings: List[VulnerabilityFinding] = field(default_factory=list)
    stats: Dict[str, int] = field(default_factory=lambda: {"total_requests": 0, "vulns_found": 0})
    traffic_history: List[TrafficLog] = field(default_factory=list)
